---
title: 工作笔记
link: link
start: 2021-01-25
date: 
updated: 
categories: 笔记
tags: [iOS, Android]
---

## 目前环境与框架

硬件: MacBook Pro 2017
OS: macOS Mojave
Android: Android Studio3.2, Java8, MVP, Retrofit
iOS: Xcode11, Swift5, Storyboard, Alamofire

## iOS 捕捉 UIImagePickerController 下拉返回事件

问题：

UIImagePickerControllerDelegate 中只有选择图片和点击取消事件，而没有下拉返回事件。而进入 UIImagePickerController 前我会使原界面进入 loading 状态，于是下拉返回后依然在 loading 状态。

解决：

> [参考](https://stackoverflow.com/questions/60809825/detect-if-imagepickercontroller-is-closed-with-swipe-down-gesture-with-objective)

注：Swift 没有匿名内部类

```swift
class X: UIAdaptivePresentationControllerDelegate {

    func presentPicker() {
        let picker = UIImagePickerController()
        picker.presentationController?.delegate = self
    }

    func presentationControllerDidDismiss(_ presentationController: UIPresentationController) {
        //TODO: 取消 loading
    }

}
```

## iOS 模拟器模拟两点点击

按住⌥：显示两点，位置以模拟器中心点中心对称
按住⇧⌥：固定两点相对位置

似乎不能模拟三点或更多点

## iOS 防止同时 push 多个 VC

> [参考](https://blog.csdn.net/qq_32117417/article/details/82868459)

```swift
class BaseNC: UINavigationController, UINavigationControllerDelegate {

    var pushing = false

    override func viewDidLoad() {
        super.viewDidLoad()
        interactivePopGestureRecognizer?.delegate = nil
        self.delegate = self
    }

    // MARK: UINavigationControllerDelegate
    func navigationController(_ navigationController: UINavigationController, didShow viewController: UIViewController, animated: Bool) {
        self.pushing = false
    }

    override func pushViewController(_ viewController: UIViewController, animated: Bool) {
        if self.pushing {
            //拦截
            return
        } else {
            self.pushing = true
            super.pushViewController(viewController, animated: true)
        }
    }

}
```

单纯地在 push 动画过程中拦截掉其他 push，如果确实需要快速 push 多个 VC 可能会误拦截。

扩展开来是重复点击的问题，Rx 的 `throttleFirst` 操作符是解决方案之一。
